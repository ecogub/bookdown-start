<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Snow Data | Snow Data Assignment: Web Scraping, Functions, and Iteration</title>
  <meta name="description" content="A recap of what I learned in ESS580A7." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Snow Data | Snow Data Assignment: Web Scraping, Functions, and Iteration" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A recap of what I learned in ESS580A7." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Snow Data | Snow Data Assignment: Web Scraping, Functions, and Iteration" />
  
  <meta name="twitter:description" content="A recap of what I learned in ESS580A7." />
  

<meta name="author" content="Nathan Mueller" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hayman-fire-recovery.html"/>
<link rel="next" href="beginner-lagos-analysis.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Bookdown Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html"><i class="fa fa-check"></i><b>1</b> R markdown Examples</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html#methods"><i class="fa fa-check"></i><b>1.1</b> Methods</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html#sitedescription"><i class="fa fa-check"></i><b>1.1.1</b> SiteDescription</a></li>
<li class="chapter" data-level="1.1.2" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html#data-acquisition-and-plotting-tests"><i class="fa fa-check"></i><b>1.1.2</b> Data Acquisition and Plotting tests</a></li>
<li class="chapter" data-level="1.1.3" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html#data-download"><i class="fa fa-check"></i><b>1.1.3</b> Data Download</a></li>
<li class="chapter" data-level="1.1.4" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html#static-data-plotter"><i class="fa fa-check"></i><b>1.1.4</b> Static Data Plotter</a></li>
<li class="chapter" data-level="1.1.5" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html#interactive-data-plotter"><i class="fa fa-check"></i><b>1.1.5</b> Interactive Data Plotter</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r-markdown-examples.html"><a href="r-markdown-examples.html#assignment"><i class="fa fa-check"></i><b>1.2</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html"><i class="fa fa-check"></i><b>2</b> Hayman Fire Recovery</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#reading-in-data"><i class="fa fa-check"></i><b>2.1</b> Reading in data</a></li>
<li class="chapter" data-level="2.2" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#assignment-1"><i class="fa fa-check"></i><b>2.2</b> Assignment</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#q1"><i class="fa fa-check"></i><b>2.2.1</b> Q1</a></li>
<li class="chapter" data-level="2.2.2" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#q2"><i class="fa fa-check"></i><b>2.2.2</b> Q2</a></li>
<li class="chapter" data-level="2.2.3" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#q3"><i class="fa fa-check"></i><b>2.2.3</b> Q3</a></li>
<li class="chapter" data-level="2.2.4" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#q4"><i class="fa fa-check"></i><b>2.2.4</b> Q4</a></li>
<li class="chapter" data-level="2.2.5" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#q5"><i class="fa fa-check"></i><b>2.2.5</b> Q5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="snow-data.html"><a href="snow-data.html"><i class="fa fa-check"></i><b>3</b> Snow Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="snow-data.html"><a href="snow-data.html#simple-web-scraping"><i class="fa fa-check"></i><b>3.1</b> Simple web scraping</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="snow-data.html"><a href="snow-data.html#reading-an-html"><i class="fa fa-check"></i><b>3.1.1</b> Reading an html</a></li>
<li class="chapter" data-level="3.1.2" data-path="snow-data.html"><a href="snow-data.html#data-download-1"><i class="fa fa-check"></i><b>3.1.2</b> Data Download</a></li>
<li class="chapter" data-level="3.1.3" data-path="snow-data.html"><a href="snow-data.html#data-read-in"><i class="fa fa-check"></i><b>3.1.3</b> Data read-in</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="snow-data.html"><a href="snow-data.html#assignment-2"><i class="fa fa-check"></i><b>3.2</b> Assignment</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="snow-data.html"><a href="snow-data.html#q1-1"><i class="fa fa-check"></i><b>3.2.1</b> Q1</a></li>
<li class="chapter" data-level="3.2.2" data-path="snow-data.html"><a href="snow-data.html#q2-1"><i class="fa fa-check"></i><b>3.2.2</b> Q2</a></li>
<li class="chapter" data-level="3.2.3" data-path="snow-data.html"><a href="snow-data.html#q3-1"><i class="fa fa-check"></i><b>3.2.3</b> Q3</a></li>
<li class="chapter" data-level="3.2.4" data-path="snow-data.html"><a href="snow-data.html#q4-1"><i class="fa fa-check"></i><b>3.2.4</b> Q4</a></li>
<li class="chapter" data-level="3.2.5" data-path="snow-data.html"><a href="snow-data.html#q5-1"><i class="fa fa-check"></i><b>3.2.5</b> Q5</a></li>
<li class="chapter" data-level="3.2.6" data-path="snow-data.html"><a href="snow-data.html#q6"><i class="fa fa-check"></i><b>3.2.6</b> Q6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html"><i class="fa fa-check"></i><b>4</b> Beginner LAGOS Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#loading-in-data"><i class="fa fa-check"></i><b>4.1</b> Loading in data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#first-download-and-then-specifically-grab-the-locus-or-site-lat-longs"><i class="fa fa-check"></i><b>4.1.1</b> First download and then specifically grab the locus (or site lat longs)</a></li>
<li class="chapter" data-level="4.1.2" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#convert-to-spatial-data"><i class="fa fa-check"></i><b>4.1.2</b> Convert to spatial data</a></li>
<li class="chapter" data-level="4.1.3" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#subset-to-only-minnesota"><i class="fa fa-check"></i><b>4.1.3</b> Subset to only Minnesota</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#assignment-3"><i class="fa fa-check"></i><b>4.2</b> Assignment</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#q1-2"><i class="fa fa-check"></i><b>4.2.1</b> Q1</a></li>
<li class="chapter" data-level="4.2.2" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#q2-2"><i class="fa fa-check"></i><b>4.2.2</b> Q2</a></li>
<li class="chapter" data-level="4.2.3" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#q3-2"><i class="fa fa-check"></i><b>4.2.3</b> Q3</a></li>
<li class="chapter" data-level="4.2.4" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#q4-2"><i class="fa fa-check"></i><b>4.2.4</b> Q4</a></li>
<li class="chapter" data-level="4.2.5" data-path="beginner-lagos-analysis.html"><a href="beginner-lagos-analysis.html#q5-2"><i class="fa fa-check"></i><b>4.2.5</b> Q5</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Snow Data Assignment: Web Scraping, Functions, and Iteration</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="snow-data" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Snow Data</h1>
<div id="simple-web-scraping" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Simple web scraping</h2>
<p>R can read html using either rvest, xml, or xml2 packages. Here we are going to navigate to the Center for Snow and Avalance Studies <a href="https://snowstudies.org/archived-data/">Website</a> and read a table in. This table contains links to data we want to programatically download for three sites. We donâ€™t know much about these sites, but they contain incredibly rich snow, temperature, and precip data.</p>
<div id="reading-an-html" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Reading an html</h3>
<div id="extract-csv-links-from-webpage" class="section level4" number="3.1.1.1">
<h4><span class="header-section-number">3.1.1.1</span> Extract CSV links from webpage</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="snow-data.html#cb1-1" aria-hidden="true" tabindex="-1"></a>site_url <span class="ot">&lt;-</span> <span class="st">&#39;https://snowstudies.org/archived-data/&#39;</span></span>
<span id="cb1-2"><a href="snow-data.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="snow-data.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Read the web url</span></span>
<span id="cb1-4"><a href="snow-data.html#cb1-4" aria-hidden="true" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(site_url)</span>
<span id="cb1-5"><a href="snow-data.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="snow-data.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#See if we can extract tables and get the data that way</span></span>
<span id="cb1-7"><a href="snow-data.html#cb1-7" aria-hidden="true" tabindex="-1"></a>tables <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="snow-data.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;table&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="snow-data.html#cb1-9" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="snow-data.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-11"><a href="snow-data.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#That didn&#39;t work, so let&#39;s try a different approach</span></span>
<span id="cb1-12"><a href="snow-data.html#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="snow-data.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract only weblinks and then the URLs!</span></span>
<span id="cb1-14"><a href="snow-data.html#cb1-14" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb1-15"><a href="snow-data.html#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;a&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="snow-data.html#cb1-16" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">grepl</span>(<span class="st">&#39;24hr&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="snow-data.html#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="data-download-1" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Data Download</h3>
<div id="download-data-in-a-for-loop" class="section level4" number="3.1.2.1">
<h4><span class="header-section-number">3.1.2.1</span> Download data in a for loop</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="snow-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grab only the name of the file by splitting out on forward slashes</span></span>
<span id="cb2-2"><a href="snow-data.html#cb2-2" aria-hidden="true" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(links,<span class="st">&#39;/&#39;</span>,<span class="dv">8</span>)</span>
<span id="cb2-3"><a href="snow-data.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="snow-data.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only the 8th column</span></span>
<span id="cb2-5"><a href="snow-data.html#cb2-5" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> splits[,<span class="dv">8</span>] </span>
<span id="cb2-6"><a href="snow-data.html#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="snow-data.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a file list for where the data goes</span></span>
<span id="cb2-8"><a href="snow-data.html#cb2-8" aria-hidden="true" tabindex="-1"></a>file_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;data/&#39;</span>,dataset)</span>
<span id="cb2-9"><a href="snow-data.html#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="snow-data.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb2-11"><a href="snow-data.html#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(links[i],<span class="at">destfile=</span>file_names[i])</span>
<span id="cb2-12"><a href="snow-data.html#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="snow-data.html#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="snow-data.html#cb2-14" aria-hidden="true" tabindex="-1"></a>downloaded <span class="ot">&lt;-</span> <span class="fu">file.exists</span>(file_names)</span>
<span id="cb2-15"><a href="snow-data.html#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="snow-data.html#cb2-16" aria-hidden="true" tabindex="-1"></a>evaluate <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">all</span>(downloaded)</span></code></pre></div>
</div>
<div id="download-data-in-a-map" class="section level4" number="3.1.2.2">
<h4><span class="header-section-number">3.1.2.2</span> Download data in a map</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="snow-data.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Map version of the same for loop (downloading 3 files)</span></span>
<span id="cb3-2"><a href="snow-data.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(evaluate <span class="sc">==</span> T){</span>
<span id="cb3-3"><a href="snow-data.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map2</span>(links[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],file_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],download.file)</span>
<span id="cb3-4"><a href="snow-data.html#cb3-4" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{<span class="fu">print</span>(<span class="st">&#39;data already downloaded&#39;</span>)}</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0
## 
## [[2]]
## [1] 0
## 
## [[3]]
## [1] 0</code></pre>
</div>
</div>
<div id="data-read-in" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Data read-in</h3>
<div id="read-in-just-the-snow-data-as-a-loop" class="section level4" number="3.1.3.1">
<h4><span class="header-section-number">3.1.3.1</span> Read in just the snow data as a loop</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="snow-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pattern matching to only keep certain files</span></span>
<span id="cb5-2"><a href="snow-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a>snow_files <span class="ot">&lt;-</span> file_names <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="snow-data.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  .[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;SG_24&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="snow-data.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  .[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;PTSP&#39;</span>,.)]</span>
<span id="cb5-5"><a href="snow-data.html#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="snow-data.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#empty_data &lt;- list()</span></span>
<span id="cb5-7"><a href="snow-data.html#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="snow-data.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># snow_data &lt;- for(i in 1:length(snow_files)){</span></span>
<span id="cb5-9"><a href="snow-data.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   empty_data[[i]] &lt;- read_csv(snow_files[i]) %&gt;%</span></span>
<span id="cb5-10"><a href="snow-data.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     select(Year,DOY,Sno_Height_M)</span></span>
<span id="cb5-11"><a href="snow-data.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb5-12"><a href="snow-data.html#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="snow-data.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#snow_data_full &lt;- do.call(&#39;rbind&#39;,empty_data)</span></span>
<span id="cb5-14"><a href="snow-data.html#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="snow-data.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(snow_data_full)</span></span></code></pre></div>
</div>
<div id="read-in-the-data-as-a-map-function" class="section level4" number="3.1.3.2">
<h4><span class="header-section-number">3.1.3.2</span> Read in the data as a map function</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="snow-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a>our_snow_reader <span class="ot">&lt;-</span> <span class="cf">function</span>(file){</span>
<span id="cb6-2"><a href="snow-data.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">=</span> <span class="fu">str_split_fixed</span>(file,<span class="st">&#39;/&#39;</span>,<span class="dv">2</span>)[,<span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="snow-data.html#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">&#39;_24hr.csv&#39;</span>,<span class="st">&#39;&#39;</span>,.)</span>
<span id="cb6-4"><a href="snow-data.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="snow-data.html#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Year,DOY,Sno_Height_M) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="snow-data.html#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">site =</span> name)</span>
<span id="cb6-7"><a href="snow-data.html#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="snow-data.html#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="snow-data.html#cb6-9" aria-hidden="true" tabindex="-1"></a>snow_data_full <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(snow_files,our_snow_reader)</span></code></pre></div>
<pre><code>## 
## -- Column specification ---------------------------------------------------------------------------------------------------------
## cols(
##   .default = col_double()
## )
## i Use `spec()` for the full column specifications.
## 
## 
## -- Column specification ---------------------------------------------------------------------------------------------------------
## cols(
##   .default = col_double()
## )
## i Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="snow-data.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(snow_data_full)</span></code></pre></div>
<pre><code>##       Year           DOY         Sno_Height_M        site          
##  Min.   :2003   Min.   :  1.0   Min.   :-3.523   Length:12786      
##  1st Qu.:2008   1st Qu.: 92.0   1st Qu.: 0.350   Class :character  
##  Median :2012   Median :183.0   Median : 0.978   Mode  :character  
##  Mean   :2012   Mean   :183.1   Mean   : 0.981                     
##  3rd Qu.:2016   3rd Qu.:274.0   3rd Qu.: 1.520                     
##  Max.   :2021   Max.   :366.0   Max.   : 2.905                     
##                                 NA&#39;s   :4554</code></pre>
</div>
<div id="plot-snow-data" class="section level4" number="3.1.3.3">
<h4><span class="header-section-number">3.1.3.3</span> Plot snow data</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="snow-data.html#cb10-1" aria-hidden="true" tabindex="-1"></a>snow_yearly <span class="ot">&lt;-</span> snow_data_full <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="snow-data.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year,site) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="snow-data.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(Sno_Height_M,<span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;Year&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="snow-data.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(snow_yearly,<span class="fu">aes</span>(<span class="at">x=</span>Year,<span class="at">y=</span>mean_height,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="snow-data.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="snow-data.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb12-4"><a href="snow-data.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="assignment-2" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Assignment</h2>
<div id="q1-1" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Q1</h3>
<p>Extract the meteorological data URLs. Here we want you to use the <code>rvest</code> package to get the URLs for the <code>SASP forcing</code> and <code>SBSP_forcing</code> meteorological datasets.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="snow-data.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract only weblinks and then the URLs!</span></span>
<span id="cb14-2"><a href="snow-data.html#cb14-2" aria-hidden="true" tabindex="-1"></a>met_links <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="snow-data.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;a&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="snow-data.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">grepl</span>(<span class="st">&#39;forcing&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="snow-data.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span>
<span id="cb14-6"><a href="snow-data.html#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="snow-data.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Grab only the name of the file by splitting out on forward slashes</span></span>
<span id="cb14-8"><a href="snow-data.html#cb14-8" aria-hidden="true" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(met_links,<span class="st">&#39;/&#39;</span>,<span class="dv">8</span>)</span>
<span id="cb14-9"><a href="snow-data.html#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="snow-data.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only the 8th column</span></span>
<span id="cb14-11"><a href="snow-data.html#cb14-11" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> splits[,<span class="dv">8</span>]</span></code></pre></div>
</div>
<div id="q2-1" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Q2</h3>
<p>Download the meteorological data. Use the <code>download_file</code> and <code>str_split_fixed</code> commands to download the data and save it in your data folder. You can use a for loop or a map function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="snow-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a file list for where the data goes</span></span>
<span id="cb15-2"><a href="snow-data.html#cb15-2" aria-hidden="true" tabindex="-1"></a>file_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;data/&#39;</span>,dataset)</span>
<span id="cb15-3"><a href="snow-data.html#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="snow-data.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb15-5"><a href="snow-data.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(met_links[i],<span class="at">destfile=</span>file_names[i])</span>
<span id="cb15-6"><a href="snow-data.html#cb15-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-7"><a href="snow-data.html#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="snow-data.html#cb15-8" aria-hidden="true" tabindex="-1"></a>downloaded <span class="ot">&lt;-</span> <span class="fu">file.exists</span>(file_names)</span>
<span id="cb15-9"><a href="snow-data.html#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="snow-data.html#cb15-10" aria-hidden="true" tabindex="-1"></a>evaluate <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">all</span>(downloaded)</span></code></pre></div>
</div>
<div id="q3-1" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Q3</h3>
<p>Write a custom function to read in the data and append a site column to the data.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="snow-data.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this code grabs the variable names from the metadata pdf file</span></span>
<span id="cb16-2"><a href="snow-data.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb16-3"><a href="snow-data.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdftools)</span>
<span id="cb16-4"><a href="snow-data.html#cb16-4" aria-hidden="true" tabindex="-1"></a>headers <span class="ot">&lt;-</span> <span class="fu">pdf_text</span>(<span class="st">&#39;https://snowstudies.org/wp-content/uploads/2022/02/Serially-Complete-Metadata-text08.pdf&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="snow-data.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_lines</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="snow-data.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trimws</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="snow-data.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split_fixed</span>(.,<span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>,<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="snow-data.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  .[,<span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="snow-data.html#cb16-9" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>] <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="snow-data.html#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_trim</span>(<span class="at">side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb16-11"><a href="snow-data.html#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="snow-data.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#file &lt;- file_names[1]</span></span>
<span id="cb16-13"><a href="snow-data.html#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="snow-data.html#cb16-14" aria-hidden="true" tabindex="-1"></a>read_met_data_file <span class="ot">&lt;-</span> <span class="cf">function</span>(file){</span>
<span id="cb16-15"><a href="snow-data.html#cb16-15" aria-hidden="true" tabindex="-1"></a>  site_name <span class="ot">&lt;-</span> <span class="fu">str_split</span>(file, <span class="at">pattern =</span> <span class="st">&#39;_&#39;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]</span>
<span id="cb16-16"><a href="snow-data.html#cb16-16" aria-hidden="true" tabindex="-1"></a>  data_in <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(file, <span class="at">delim =</span> <span class="st">&#39; &#39;</span>, <span class="at">col_names =</span> headers)</span>
<span id="cb16-17"><a href="snow-data.html#cb16-17" aria-hidden="true" tabindex="-1"></a>  data_in<span class="sc">$</span>site_name <span class="ot">&lt;-</span> site_name</span>
<span id="cb16-18"><a href="snow-data.html#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data_in)</span>
<span id="cb16-19"><a href="snow-data.html#cb16-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="q4-1" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Q4</h3>
<p>Use the <code>map</code> function to read in both meteorological files. Display a summary of your tibble.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="snow-data.html#cb17-1" aria-hidden="true" tabindex="-1"></a>data_out <span class="ot">&lt;-</span> <span class="fu">map</span>(file_names, read_met_data_file)</span>
<span id="cb17-2"><a href="snow-data.html#cb17-2" aria-hidden="true" tabindex="-1"></a>out_tbl <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_out[[<span class="dv">1</span>]], data_out[[<span class="dv">2</span>]])</span>
<span id="cb17-3"><a href="snow-data.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(out_tbl)</span></code></pre></div>
<pre><code>## Rows: 138,336
## Columns: 27
## $ year                                                          &lt;dbl&gt; 2003, 20~
## $ month                                                         &lt;dbl&gt; 11, 11, ~
## $ day                                                           &lt;chr&gt; &quot;10&quot;, &quot;1~
## $ hour                                                          &lt;chr&gt; &quot; 1&quot;, &quot; ~
## $ minute                                                        &lt;chr&gt; &quot; 0&quot;, &quot; ~
## $ second                                                        &lt;chr&gt; &quot;   0.0&quot;~
## $ `precip [kg m-2 s-1]`                                         &lt;chr&gt; &quot;    0.0~
## $ `sw down [W m-2]`                                             &lt;chr&gt; &quot; -9999.~
## $ `lw down [W m-2]`                                             &lt;chr&gt; &quot; -9999.~
## $ `air temp [K]`                                                &lt;chr&gt; &quot;   270.~
## $ `windspeed [m s-1]`                                           &lt;chr&gt; &quot; -9999.~
## $ `relative humidity [%]`                                       &lt;chr&gt; &quot;    91.~
## $ `pressure [Pa]`                                               &lt;chr&gt; &quot; 66863.~
## $ `specific humidity [g g-1]`                                   &lt;chr&gt; &quot;   4.18~
## $ `calculated dewpoint temperature [K]`                         &lt;chr&gt; &quot;  0&quot;, &quot;~
## $ `precip, WMO-corrected [kg m-2 s-1]`                          &lt;dbl&gt; 2000, 20~
## $ `air temp, corrected with Kent et al. (1993) [K]`             &lt;chr&gt; &quot;3000&quot;, ~
## $ `air temp, corrected with Anderson and Baumgartner (1998)[K]` &lt;chr&gt; &quot;   0&quot;, ~
## $ `air temp, corrected with Nakamura and Mahrt (2005) [K]`      &lt;chr&gt; &quot;4009&quot;, ~
## $ `air temp, corrected with Huwald et al. (2009) [K]`           &lt;chr&gt; &quot;   0&quot;, ~
## $ `qc code precip`                                              &lt;chr&gt; NA, NA, ~
## $ `qc code sw down`                                             &lt;chr&gt; NA, NA, ~
## $ `qc code lw down`                                             &lt;chr&gt; NA, NA, ~
## $ `qc code air temp`                                            &lt;chr&gt; NA, NA, ~
## $ `qc code wind speed`                                          &lt;chr&gt; NA, NA, ~
## $ `qc code relhum`                                              &lt;chr&gt; NA, NA, ~
## $ site_name                                                     &lt;chr&gt; &quot;SASP&quot;, ~</code></pre>
</div>
<div id="q5-1" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Q5</h3>
<p>Make a line plot of mean temp by year by site (using the <code>air temp [K]</code> variable). Is there anything suspicious in the plot? Adjust your filtering if needed.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="snow-data.html#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_tbl <span class="ot">&lt;-</span> out_tbl <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="snow-data.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">make_datetime</span>(year, month, <span class="fu">as.numeric</span>(day), <span class="fu">as.numeric</span>(hour), <span class="fu">as.numeric</span>(minute), <span class="fu">as.numeric</span>(second)),</span>
<span id="cb19-3"><a href="snow-data.html#cb19-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">air temp [K]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">air temp [K]</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="snow-data.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, <span class="st">`</span><span class="at">air temp [K]</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="snow-data.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb19-6"><a href="snow-data.html#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="snow-data.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> <span class="st">`</span><span class="at">air temp [K]</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb19-8"><a href="snow-data.html#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>R is interpolating over periods of no data, leading to long, awkward gaps. If we become interested in performing annual analyses we could either interpolate them or make them explicitly NA.</p>
</div>
<div id="q6" class="section level3" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> Q6</h3>
<p>Write a function that makes line plots of monthly average temperature at each site for a given year. Use a for loop to make these plots for 2005 to 2010. Are monthly average temperatures at the Senator Beck Study Plot ever warmer than the Snow Angel Study Plot?
Hint: <a href="https://ggplot2.tidyverse.org/reference/print.ggplot.html" class="uri">https://ggplot2.tidyverse.org/reference/print.ggplot.html</a></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="snow-data.html#cb20-1" aria-hidden="true" tabindex="-1"></a>six_tbl <span class="ot">&lt;-</span> out_tbl <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="snow-data.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">make_datetime</span>(year, month, <span class="fu">as.numeric</span>(day), <span class="fu">as.numeric</span>(hour), <span class="fu">as.numeric</span>(minute), <span class="fu">as.numeric</span>(second)),</span>
<span id="cb20-3"><a href="snow-data.html#cb20-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">air_temp_k =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">air temp [K]</span><span class="st">`</span>))</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="snow-data.html#cb21-1" aria-hidden="true" tabindex="-1"></a>make_monthly_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">target_year =</span> <span class="dv">2008</span>){</span>
<span id="cb21-2"><a href="snow-data.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> six_tbl</span>
<span id="cb21-3"><a href="snow-data.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-4"><a href="snow-data.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  fun_data <span class="ot">&lt;-</span> six_tbl <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="snow-data.html#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> target_year,</span>
<span id="cb21-6"><a href="snow-data.html#cb21-6" aria-hidden="true" tabindex="-1"></a>           <span class="sc">!</span><span class="fu">is.na</span>(month),</span>
<span id="cb21-7"><a href="snow-data.html#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">air temp [K]</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="snow-data.html#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(month, site_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="snow-data.html#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean_air_temp_k =</span> <span class="fu">mean</span>(air_temp_k),</span>
<span id="cb21-10"><a href="snow-data.html#cb21-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">site_name =</span> site_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="snow-data.html#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb21-12"><a href="snow-data.html#cb21-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-13"><a href="snow-data.html#cb21-13" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fun_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.character</span>(month), <span class="at">y =</span> mean_air_temp_k, <span class="at">color =</span> site_name))<span class="sc">+</span></span>
<span id="cb21-14"><a href="snow-data.html#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb21-15"><a href="snow-data.html#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb21-16"><a href="snow-data.html#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(target_year, <span class="st">&#39;Monthly Air Temp&#39;</span>),</span>
<span id="cb21-17"><a href="snow-data.html#cb21-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span><span class="st">&#39;Month&#39;</span>,</span>
<span id="cb21-18"><a href="snow-data.html#cb21-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;Air temperature (mean, monthly, K)&#39;</span>,</span>
<span id="cb21-19"><a href="snow-data.html#cb21-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&#39;Site&#39;</span>)</span>
<span id="cb21-20"><a href="snow-data.html#cb21-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-21"><a href="snow-data.html#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb21-22"><a href="snow-data.html#cb21-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-23"><a href="snow-data.html#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="snow-data.html#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">2005</span><span class="sc">:</span><span class="dv">2010</span>, make_monthly_plots)</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-13-3.png" width="672" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-13-4.png" width="672" /></p>
<pre><code>## 
## [[5]]</code></pre>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-13-5.png" width="672" /></p>
<pre><code>## 
## [[6]]</code></pre>
<p><img src="bookdown-start_files/figure-html/unnamed-chunk-13-6.png" width="672" /></p>
<p>The monthly average temperatures and slighlty lower at Senator Beck.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hayman-fire-recovery.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="beginner-lagos-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
